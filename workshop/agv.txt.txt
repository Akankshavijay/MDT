@startuml
title Sequence Diagram â€“ Unified Logging Flow (Storage + AGV + Warehouse)

actor "User / Scheduler" as U
participant "StorageManager" as SM
participant "WarehouseMap" as WM
participant "RobotManager" as RM
participant "AGV (R1)" as AGV
participant "LogManager" as LM
participant "File System" as FS

U -> SM : addBin(B1)
SM -> LM : log("StorageSystem", "Added bin B1")
SM -> WM : computeDistances(entry, exit)
WM -> LM : saveWarehouseSnapshot(WM, "StorageSystem")

U -> RM : assignTask(T1)
RM -> AGV : perform(T1)
AGV -> LM : log("RobotSystem", "AGV R1 started task T1")
AGV -> LM : saveAsJson("RobotSystem", currentStateJSON)
AGV -> LM : log("RobotSystem", "AGV R1 completed task T1")

LM -> FS : write logs/StorageSystem/*.log
LM -> FS : write logs/StorageSystem/*.json
LM -> FS : write logs/RobotSystem/*.log
LM -> FS : write logs/RobotSystem/*.json

note right of FS
  - Rotation: every 5s
  - JSON contains AGV state and warehouse layout
end note

@enduml
